(window["wpJsonpExtractCss"]=window["wpJsonpExtractCss"]||[]).push([[40],{"./src/main/webapp/universal/src/apps/App/components/Annotations/utils/trackHeaderChangeToRender.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.trackLayoutChangeWithTiming=t.trackOptionChangeWithTiming=t.getQueuedTrackAfterRender=void 0;var s=n(a("./common/temp/node_modules/@babel/runtime/regenerator/index.js"));var r=n(a("./common/temp/node_modules/@babel/runtime/helpers/asyncToGenerator.js"));var o=n(a("./common/temp/node_modules/lodash/debounce.js"));var l=a("./common/temp/node_modules/@sqs/rum-collector/lib/index.js");var i=a("./src/main/webapp/frontend/packages/websites-constants/lib/index.js");var d=n(a("./src/main/webapp/universal/src/shared/utils/CMSV7EventsCollectionHelpers.js"));var u;var c=function e(){var t=u||function(){};u=null;return t};t.getQueuedTrackAfterRender=c;var m=function e(t){u=t};var p=(0,o.default)(function(e,t,a){d.default.userChangesHeaderOptionFinish(a,{fieldPath:e,newFieldValue:t})},400);var f=function(){var n=(0,r.default)(s.default.mark(function e(a,n){var r;return s.default.wrap(function e(t){while(1)switch(t.prev=t.next){case 0:r=d.default.userChangesHeaderOptionStart();m(function(){p(a,n,r)});case 2:case"end":return t.stop()}},e)}));return function e(t,a){return n.apply(this,arguments)}}();t.trackOptionChangeWithTiming=f;var h=function e(){(0,l.mark)(i.CMSPerformanceEvents.HEADER_NEW_LAYOUT_LOAD);m(function(){(0,l.measure)(i.CMSPerformanceEvents.HEADER_NEW_LAYOUT_LOAD,{requireStart:true})})};t.trackLayoutChangeWithTiming=h},"./src/main/webapp/universal/src/apps/App/screens/ContentBrowser/shared/components/customFields/ImageField.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireWildcard.js");var r=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var y=r(a("./common/temp/node_modules/@babel/runtime/helpers/extends.js"));var u=r(a("./common/temp/node_modules/@babel/runtime/regenerator/index.js"));var s=r(a("./common/temp/node_modules/@babel/runtime/helpers/asyncToGenerator.js"));var o=r(a("./common/temp/node_modules/@babel/runtime/helpers/classCallCheck.js"));var l=r(a("./common/temp/node_modules/@babel/runtime/helpers/createClass.js"));var i=r(a("./common/temp/node_modules/@babel/runtime/helpers/assertThisInitialized.js"));var d=r(a("./common/temp/node_modules/@babel/runtime/helpers/inherits.js"));var c=r(a("./common/temp/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));var m=r(a("./common/temp/node_modules/@babel/runtime/helpers/getPrototypeOf.js"));var f=r(a("./common/temp/node_modules/@babel/runtime/helpers/defineProperty.js"));var h=r(a("./common/temp/node_modules/lodash/pick.js"));var v=r(a("./common/temp/node_modules/lodash/isObject.js"));var C=r(a("./common/temp/node_modules/lodash/isFunction.js"));var g=r(a("./common/temp/node_modules/lodash/isEmpty.js"));var I=r(a("./common/temp/node_modules/lodash/debounce.js"));var w=r(a("./common/temp/node_modules/lodash/omit.js"));a("./src/main/webapp/universal/src/shared/i18n/configurations/core-components.js");var p=r(a("./common/temp/node_modules/prop-types/index.js"));var k=n(a("./common/temp/node_modules/react/index.js"));var j=a("./common/temp/node_modules/@sqs/core-components/build/lib/index.js");var O=a("./common/temp/node_modules/@sqs/rosetta-primitives/build/lib/index.js");var b=a("./common/temp/node_modules/@sqs/rosetta-elements/build/lib/index.js");var P=a("./src/main/webapp/frontend/packages/enums/RecordType.js");var A=r(a("./src/main/webapp/frontend/packages/enums/WorkflowStates.js"));var _=a("./src/main/webapp/frontend/packages/enums/LicensedAssetSource.js");var F=a("./src/main/webapp/universal/src/apps/App/screens/ContentBrowser/externals.js");var T=r(a("./src/main/webapp/universal/src/apps/App/screens/ContentBrowser/shared/components/customFields/ImageField.less"));function E(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}));a.push.apply(a,n)}return a}function S(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?E(Object(a),true).forEach(function(e){(0,f.default)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function U(r){var s=R();return function e(){var t=(0,m.default)(r),a;if(s){var n=(0,m.default)(this).constructor;a=Reflect.construct(t,arguments,n)}else a=t.apply(this,arguments);return(0,c.default)(this,a)}}function R(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}var D={UPLOAD_DONE:"uploadDone",UPLOAD_CANCELED:"uploadCanceled",PROCESSING_DONE:"processingDone"};var x={mediaFocalPoint:{x:.5,y:.5},licensedAssetPreview:null,assetUrl:"",licensedAssetId:null};var L=function e(){return k.default.createElement(O.Box,{px:2},k.default.createElement(b.Divider,null))};var M=function(e){(0,d.default)(E,e);var n=U(E);function E(){var p;(0,o.default)(this,E);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];p=n.call.apply(n,[this].concat(t));(0,f.default)((0,i.default)(p),"state",S({},x,{imageEditorOpen:false,showLicensedAssetPicker:!p.props.value&&p.props.licensedAssetDestination,purchaseModalOpen:false,licensedAssetType:null,licensedAssetUrl:null}));(0,f.default)((0,i.default)(p),"getImageId",function(){var e;var t=p.props.value;if(!(0,v.default)(t))return t;return null===t||void 0===t?void 0:null===(e=t.image)||void 0===e?void 0:e.id});(0,f.default)((0,i.default)(p),"updateStateForNewContentItem",(0,s.default)(u.default.mark(function e(){var a,n,r,s,o,l,i,d;return u.default.wrap(function e(t){while(1)switch(t.prev=t.next){case 0:a=p.props,n=a.focalPointEditable,r=a.focalPointOverride,s=a.imageEditable,o=a.licensedAssetDestination;l=p.getImageId();if(!((n||s||o)&&l)){t.next=8;break}t.next=5;return p.fetchContentItemData(l);case 5:i=t.sent;d=(0,h.default)(i,Object.keys(x));p.setState(S({},d,{mediaFocalPoint:r||d.mediaFocalPoint||x.mediaFocalPoint}));case 8:case"end":return t.stop()}},e)})));(0,f.default)((0,i.default)(p),"fetchContentItemData",function(e){return F.ContentItemAPI.read(e).then(function(e){var t=e.data;return t})});(0,f.default)((0,i.default)(p),"updateFocalPoint",(0,I.default)(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var a=p.props,n=a.onFocalPointChange,r=a.focalPointEditable;var s=p.getImageId();if(!s||!r)return;n?n(e):t&&F.ContentItemAPI.updateField({itemId:s,field:"mediaFocalPoint",value:e})},500));(0,f.default)((0,i.default)(p),"getLicensedAssetProps",function(e){var t=F.PurchasedImageStore.getOriginUrlFromId(e)||"";var a=F.PurchasedImageStore.getAssetTypeFromId(e)||null;return{licensedAssetUrl:t,licensedAssetType:a}});(0,f.default)((0,i.default)(p),"handleRemove",function(){var e=p.state,t=e.licensedAssetPreview,a=e.licensedAssetId,n=e.licensedAssetType;t?(0,F.trackInternal)("getty_clear",{assetId:t.assetId,assetSource:_.GETTY}):a&&(0,F.trackInternal)("licensed_asset_remove",{assetId:a,assetSource:n});p.handleChange({})});(0,f.default)((0,i.default)(p),"handleChange",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t=p.props,a=t.onChange,n=t.licensedAssetDestination,r=t.value;var s=p.state,o=s.assetUrl,l=s.mediaFocalPoint;var i=p.getLicensedAssetProps(e.licensedAssetId);var d=(0,g.default)(e);var u=p.getImageId()===e.id;var c=o===e.assetUrl;var m=e.mediaFocalPoint!==l;!d&&u&&m?p.updateFocalPoint(e.mediaFocalPoint):u||p.updateFocalPoint({x:.5,y:.5},false);(0,v.default)(r)?a(S({},r,{image:e.id?S({},r.image,{focalPoint:e.mediaFocalPoint},e):{}}),{isSameImage:u}):a(e.id,{isSameImage:u});u&&!c&&F.ContentItemActions.read(e.id).then(function(e){var t,a;null===(t=(a=p.props).onAssetUrlChange)||void 0===t?void 0:t.call(a,e)});p.setState(S({},(0,h.default)(e,Object.keys(x)),{},i,{showLicensedAssetPicker:!e.id&&n}));e.assetUrls&&e.assetUrls[0].url!==o&&p.setState({assetUrl:e.assetUrls[0].url})});(0,f.default)((0,i.default)(p),"handleUploadEvent",function(e){var t=p.getImageId();e.action===D.UPLOAD_DONE?p.setState({showLicensedAssetPicker:false}):e.action===D.UPLOAD_CANCELED&&p.props.licensedAssetDestination&&!t&&p.setState({showLicensedAssetPicker:true})});(0,f.default)((0,i.default)(p),"handleChooseAssetIds",function(e){var t=e.assetIds;F.ImagePickerViewActions.closeImagePicker();if(p.props.uploadData&&p.props.uploadData.replaceItemId){var a=p.props.uploadData,n=a.collectionId,r=a.replaceItemId;(0,F.createContentItemFromAsset)(F.AssetReferenceType.COLLECTION_IMAGE,t[0],n,r).then(p.handleChange)}else(0,F.createContentItemFromAsset)(F.AssetReferenceType.TRANSIENT_IMAGE,t[0]).then(p.handleChange)});(0,f.default)((0,i.default)(p),"handleChooseImageUrl",function(e){var t=e.data;if(!p.props.uploaderRef.current){false;return}F.ImagePickerViewActions.closeImagePicker();var a=t.licensedAssetId,n=t.url;p.setState({licensedAssetId:a,licensedAssetUrl:n},function(){p.props.uploaderRef.current.uploadFileFromUrl(S({},p.props.uploadData,{},(0,F.buildUploadPostData)(t,P.IMAGE,F.TRANSIENT)))})});(0,f.default)((0,i.default)(p),"handleLicensedImagePicked",function(e){if(!p.props.uploaderRef.current){console.error("Image Uploader not ready.");return}F.ImagePickerViewActions.finishLoadingImage();F.ImagePickerViewActions.closeImagePicker();if(e.cloneItemId){F.ContentItemAPI.copy(e.cloneItemId,A.default.PUBLISHED,null).then(function(e){var t=e.data;return p.handleChange(t)});return}var t=e.licensedAssetId,a=e.url;p.setState({licensedAssetId:t,licensedAssetUrl:a},function(){p.props.uploaderRef.current.uploadFileFromUrl(S({},p.props.uploadData,{},(0,F.buildUploadPostData)(e,P.IMAGE,F.TRANSIENT)))})});(0,f.default)((0,i.default)(p),"handleSaveImageEditor",function(e){if(!p.props.uploaderRef.current){console.error("Image Uploader not ready.");return}p.setState({imageEditorOpen:false});p.props.uploaderRef.current.uploadFiles([e])});(0,f.default)((0,i.default)(p),"handlePurchase",function(e){if(!p.props.uploaderRef.current){console.error("Image Uploader not ready.");return}var t=p.getImageId();p.props.uploaderRef.current.uploadFileFromUrl((0,F.buildUploadPostData)(e,P.IMAGE,F.TRANSIENT,{replaceItemId:t}));p.setState({licensedAssetPreview:null});p.handleClosePurchaseModal()});(0,f.default)((0,i.default)(p),"handleClickEdit",function(){p.props.onClickEdit?p.props.onClickEdit():p.setState({imageEditorOpen:true})});(0,f.default)((0,i.default)(p),"handleCloseImageEditor",function(){p.setState({imageEditorOpen:false})});(0,f.default)((0,i.default)(p),"handleOpenPurchaseModal",function(){var e=p.state.licensedAssetPreview;p.setState({purchaseModalOpen:true});(0,F.trackInternal)("getty_purchase",{assetId:e.assetId,assetSource:_.GETTY})});(0,f.default)((0,i.default)(p),"handleClosePurchaseModal",function(){p.setState({purchaseModalOpen:false})});(0,f.default)((0,i.default)(p),"renderLeftButton",function(){var e=p.state,t=e.licensedAssetPreview,a=e.assetUrl;if(t)return k.default.createElement(O.Button.Tertiary,{onClick:p.handleOpenPurchaseModal},(0,F.t)("Purchase License"));if(a)return k.default.createElement(O.Button.Tertiary,{onClick:p.handleClickEdit,"data-test":"file-button-edit"},(0,F.t)("Image Editor"));return null});return p}(0,l.default)(E,[{key:"componentDidMount",value:function(){var e=(0,s.default)(u.default.mark(function e(){var a;return u.default.wrap(function e(t){while(1)switch(t.prev=t.next){case 0:t.next=2;return this.updateStateForNewContentItem();case 2:if(!this.state.licensedAssetId){t.next=8;break}a=F.PurchasedImageStore.getImageById(this.state.licensedAssetId);if(a){t.next=7;break}t.next=7;return F.PurchasedImageActions.fetch();case 7:this.setState(this.getLicensedAssetProps(this.state.licensedAssetId));case 8:case"end":return t.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"componentDidUpdate",value:function e(t){t.focalPointOverride!==this.props.focalPointOverride&&this.setState({mediaFocalPoint:this.props.focalPointOverride})}},{key:"componentWillUnmount",value:function e(){this.updateFocalPoint.flush()}},{key:"getFocalPoint",value:function e(){var t=this.state.mediaFocalPoint;var a=this.props.invertFocalPoint;var n=t.x,r=t.y;return{x:n,y:a?1-r:r}}},{key:"getPreviewComponent",value:function e(){var n=this;var t=this.props,a=t.height,r=t.focalPointEditable,s=t.invertFocalPoint,o=t.previewKey,l=t.renderPreview;if(l)return l;var i=this.getImageId();var d={value:i,maxHeight:a,dataField:false};var u={focalPoint:this.getFocalPoint(),onFocalPointChange:function e(t,a){return n.handleChange({id:i,mediaFocalPoint:{x:t,y:s?1-a:a}})}};if(r)return function(){return k.default.createElement(j.ImageField,(0,y.default)({key:o},d,u))};return function(){return k.default.createElement(j.ImageField,d)}}},{key:"render",value:function e(){var t;var a=this.state,n=a.imageEditorOpen,r=a.assetUrl,s=a.showLicensedAssetPicker,o=a.licensedAssetPreview,l=a.purchaseModalOpen,i=a.licensedAssetId,d=a.licensedAssetUrl,u=a.licensedAssetType;var c=this.props,m=c.value,p=c.licensedAssetDestination,f=c.imageEditable,h=c.mimeTypes,v=c.height,g=c.errors,I=c.getUploadUrl;var b=this.getImageId();var P=f||o;var A;(0,C.default)(I)&&(A=I(m,i));return k.default.createElement(k.Fragment,null,k.default.createElement(j.FileUpload,(0,y.default)({},(0,w.default)(this.props,Object.keys(E.propTypes)),{uploadUrl:A,ref:this.props.uploaderRef,dispatchValueType:"contentItem",onChange:this.handleChange,onEvent:this.handleUploadEvent,value:b,shouldRenderButtons:!P,height:v,className:T.default.uploadField,mimeTypes:h,fileType:"image",renderPreview:this.getPreviewComponent(),errors:g,"data-test":"image-field"})),b&&P&&k.default.createElement(k.Fragment,null,k.default.createElement("div",{className:T.default.previewButtons},this.renderLeftButton(),k.default.createElement(O.Button.Danger,{onClick:this.handleRemove},(0,F.t)("Remove Image"))),k.default.createElement(L,null)),b&&o&&k.default.createElement(k.Fragment,null,k.default.createElement(j.Context,{type:"label",description:(0,F.t)("This is an unlicensed preview image. To purchase its license, click the Purchase License button above. Watermarks will be removed after purchase")}),k.default.createElement(F.LicensedImagePurchaseModal,{key:"licensed-image-purchase-modal",assetPreview:o,previewUrl:r,isOpen:l,onRequestClose:this.handleClosePurchaseModal,onPurchaseSuccess:this.handlePurchase})),i&&u===_.GETTY&&k.default.createElement(j.Context,{type:"label",description:(0,F.t)("This is a licensed image. Click {link} to review licensing options for print, social, and more.",{link:'<a href="'.concat(d,'" target="_blank">\n              ').concat((0,F.t)("here"),"</a>")})}),s&&k.default.createElement(k.Fragment,null,k.default.createElement(O.Button.Tertiary,{m:2,ml:3,onClick:F.ImagePickerViewActions.openImagePicker,"data-test":"file-button-licensed-image-get"},(0,F.t)("Search For Images")),k.default.createElement(L,null),k.default.createElement(F.LicensedImagePicker,{disableImageReuse:this.props.disableImageReuse,onChooseAssetIds:this.handleChooseAssetIds,onChooseImageUrl:this.handleChooseImageUrl,onUnlicensedPreview:this.handleLicensedImagePicked,onLicensedPreview:this.handleLicensedImagePicked,imageDestination:p})),r&&f&&k.default.createElement(F.ImageEditor,{isOpen:n,imageSrc:r,imageFileName:null===m||void 0===m?void 0:null===(t=m.image)||void 0===t?void 0:t.filename,onCancel:this.handleCloseImageEditor,onSave:this.handleSaveImageEditor}))}}]);return E}(k.Component);(0,f.default)(M,"propTypes",{value:p.default.oneOfType([p.default.string,p.default.object]),onChange:p.default.func.isRequired,onClickEdit:p.default.func,onFocalPointChange:p.default.func,licensedAssetDestination:p.default.string,focalPointEditable:p.default.bool,focalPointOverride:p.default.shape({x:p.default.number,y:p.default.number}),imageEditable:p.default.bool,invertFocalPoint:p.default.bool,mimeTypes:p.default.arrayOf(p.default.string),height:p.default.number,errors:p.default.object,collectionId:p.default.string,getUploadUrl:p.default.func,renderPreview:p.default.func,disableImageReuse:p.default.bool});(0,f.default)(M,"defaultProps",{focalPointEditable:true,height:168,imageEditable:true,invertFocalPoint:true,mimeTypes:["image/gif","image/jpeg","image/png"]});var N=k.default.forwardRef(function(e,t){var a=(0,k.useRef)();return k.default.createElement(M,(0,y.default)({},e,{uploaderRef:t||a}))});t.default=N;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/screens/ContentBrowser/shared/components/customFields/ImageField.less":function(e,t,a){e.exports={previewButtons:"_2rSSpQd-a",uploadField:"_2JOHcfl8P"}},"./src/main/webapp/universal/src/apps/App/shared/utils/getThemeEditorPath.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=n(a("./src/main/webapp/universal/src/apps/App/shared/utils/isColorsPanelImprovementsEnabled.js"));var s=function e(){if((0,r.default)())return"/config/design/site-styles/colors/theme-editor";return"/config/design/site-styles/colors/color-themes/theme-editor"};t.default=s;e.exports=t.default},"./src/main/webapp/universal/src/apps/App/shared/utils/hooks/useEventListener.js":function(e,t,a){"use strict";var n=a("./common/temp/node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:true});t.default=r;var m=n(a("./common/temp/node_modules/@babel/runtime/helpers/toConsumableArray.js"));var p=n(a("./common/temp/node_modules/lodash/isUndefined.js"));var f=a("./common/temp/node_modules/react/index.js");function r(a,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=t.deps,r=void 0===n?[]:n,s=t.element,o=void 0===s?document.body:s,l=t.useCapture,i=t.passive,d=t.shouldListen,u=void 0===d||d;var c=(0,f.useRef)();(0,f.useEffect)(function(){c.current=e},[e]);(0,f.useEffect)(function(){if(!o)return;if(u){var e={};(0,p.default)(l)||(e.capture=l);(0,p.default)(i)||(e.passive=i);var t=function e(t){return c.current(t)};setTimeout(function(){return o.addEventListener(a,t,e)});return function(){o.removeEventListener(a,t,e)}}},[a,o,u,i,l].concat((0,m.default)(r)))}e.exports=t.default}}]);
//# sourceMappingURL=https://sourcemaps.squarespace.net/universal/scripts-compressed/40-b9ff42b1b52a20a562d4d-min.en-US.js.map